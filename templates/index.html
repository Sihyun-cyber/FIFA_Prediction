<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>âš½ FIFA ì„ ìˆ˜ ì—ì´ì§• ì»¤ë¸Œ ì˜ˆì¸¡</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">
    
    <style>
        /* --- ì¶•êµ¬ í…Œë§ˆ ìŠ¤íƒ€ì¼ë§ ì‹œì‘ --- */
        body {
            background-image: url('https://www.toptal.com/designers/subtlepatterns/uploads/football.png');
            font-family: 'Poppins', sans-serif;
            color: white;
        }

        .theme-card {
            background-color: rgba(13, 31, 12, 0.85); /* ë°˜íˆ¬ëª…í•œ ì–´ë‘ìš´ ë…¹ìƒ‰ */
            backdrop-filter: blur(10px); /* ë’· ë°°ê²½ ë¸”ëŸ¬ ì²˜ë¦¬ (ìœ ë¦¬ íš¨ê³¼) */
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 15px;
        }

        .lead {
            color: rgba(255, 255, 255, 0.8);
        }

        /* ì œëª©(h1) ìƒ‰ìƒì„ í°ìƒ‰ìœ¼ë¡œ ê³ ì • */
        h1 {
            font-weight: 700;
            color: white !important; 
        }
        
        /* ì…ë ¥ì°½ ìŠ¤íƒ€ì¼ */
        .form-control {
            background-color: rgba(0, 0, 0, 0.2);
            border: 1px solid rgba(255, 255, 255, 0.3);
            color: white;
        }
        .form-control:focus {
            background-color: rgba(0, 0, 0, 0.3);
            border-color: #ffcc00;
            box-shadow: 0 0 0 0.25rem rgba(255, 204, 0, 0.25);
            color: white;
        }
        .form-control::placeholder {
            color: rgba(255, 255, 255, 0.5);
        }

        /* ë²„íŠ¼ ìŠ¤íƒ€ì¼ */
        .btn-predict {
            background-color: #ffcc00; /* ê¸ˆìƒ‰ í•˜ì´ë¼ì´íŠ¸ */
            color: #0d1f0c;
            font-weight: 600;
            border: none;
            transition: all 0.3s ease;
        }
        .btn-predict:hover {
            background-color: #ffe066;
            transform: translateY(-2px);
        }

        /* ë¡œë”© ìŠ¤í”¼ë„ˆ */
        .spinner-border {
            display: none; /* ê¸°ë³¸ ìˆ¨ê¹€ */
            width: 3rem;
            height: 3rem;
            color: #ffcc00;
        }

        /* ê²°ê³¼ ì¹´ë“œ ìŠ¤íƒ€ì¼ */
        #results .card {
            background-color: rgba(255, 255, 255, 0.95); /* ê²°ê³¼ ì¹´ë“œì˜ ë°°ê²½ì„ ë°ê²Œ ë³€ê²½ */
            border: 1px solid #ffcc00; 
        }
        #results .card-header {
            background-color: transparent;
            border-bottom: 1px solid rgba(0, 0, 0, 0.1);
            text-align: center;
            color: #0d1f0c; /* í—¤ë” í…ìŠ¤íŠ¸ ìƒ‰ìƒ ë³€ê²½ */
            font-weight: 600;
        }
        #results .card-text {
            color: #212529; /* ê²°ê³¼ í…ìŠ¤íŠ¸ë¥¼ ì–´ë‘ìš´ ìƒ‰ìœ¼ë¡œ ê³ ì • */
        }
        /* --- ì¶•êµ¬ í…Œë§ˆ ìŠ¤íƒ€ì¼ë§ ë --- */
    </style>
</head>
<body>
    <div class="container my-5">
        <div class="p-5 text-center theme-card">
            <h1 class="">âš½ FIFA ì„ ìˆ˜ ì»¤ë¦¬ì–´ ì˜ˆì¸¡</h1>
            <p class="lead mt-3">
                ì„ ìˆ˜ ì´ë¦„ì„ ì…ë ¥í•˜ì—¬ ì»¤ë¦¬ì–´ì˜ ê³ ì ê³¼ ì—ì´ì§• ì»¤ë¸Œë¥¼ ì˜ˆì¸¡í•´ë³´ì„¸ìš”.<br>
                (ì˜ˆ: L. Messi, Cristiano Ronaldo, Son Heung-Min)
            </p>
            <div class="input-group input-group-lg mt-4">
                <input type="text" id="search-box" class="form-control" placeholder="ì„ ìˆ˜ ì´ë¦„ì„ ì •í™•í•˜ê²Œ ì…ë ¥í•˜ì„¸ìš”...">
                <button class="btn btn-predict" type="button" id="search-button">ì˜ˆì¸¡í•˜ê¸°</button>
            </div>
        </div>

        <div id="loading" class="text-center mt-4" style="display: none;">
            <div class="spinner-border" role="status">
                <span class="visually-hidden">Loading...</span>
            </div>
            <p class="mt-2 fw-bold">ğŸ§  ëª¨ë¸ì´ ì—´ì‹¬íˆ ì˜ˆì¸¡ ì¤‘ì…ë‹ˆë‹¤...</p>
        </div>

        <div id="results" class="mt-4"></div>
    </div>

    <script>
        const searchButton = document.getElementById('search-button');
        const searchBox = document.getElementById('search-box');
        const resultsDiv = document.getElementById('results');
        const loadingDiv = document.getElementById('loading');

        searchBox.addEventListener('keyup', function(event) {
            if (event.key === 'Enter') {
                searchButton.click();
            }
        });

        searchButton.addEventListener('click', async () => {
            const playerName = searchBox.value;
            if (!playerName) {
                alert('ì„ ìˆ˜ ì´ë¦„ì„ ì…ë ¥í•´ì£¼ì„¸ìš”!');
                return;
            }

            resultsDiv.innerHTML = '';
            loadingDiv.style.display = 'block';

            try {
                const response = await fetch('/predict', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ player_name: playerName })
                });

                const data = await response.json();

                if (data.error) {
                    resultsDiv.innerHTML = `<div class="alert alert-danger" role="alert">${data.error}</div>`;
                } else {
                    const summary = data.summary;
                    let resultText = `
                        <div class="card mt-4">
                            <div class="card-header h5">${summary.player_name} ì„ ìˆ˜ ì»¤ë¦¬ì–´ ì˜ˆì¸¡</div>
                            <div class="card-body">
                                <p class="card-text fs-5">ğŸ‘‘ <strong>ê³ ì (Peak) ë¶„ì„:</strong> ì´ ì„ ìˆ˜ëŠ” ê³¼ê±° ë°ì´í„°ìƒ <strong>ë§Œ ${summary.peak_age}ì„¸ (${summary.peak_year}ë…„)</strong>ì— ê¸°ëŸ‰ì˜ ì •ì ì„ ì°ì—ˆìŠµë‹ˆë‹¤.</p>`;

                    if (summary.aging_curve_start_year) {
                        resultText += `<p class="card-text fs-5">ğŸ“‰ <strong>ì—ì´ì§• ì»¤ë¸Œ ì˜ˆì¸¡:</strong> <strong>ë§Œ ${summary.aging_curve_start_age}ì„¸ (${summary.aging_curve_start_year}ë…„)</strong>ë¶€í„° ì ì§„ì ì¸ ê¸°ëŸ‰ í•˜ë½ì´ ì‹œì‘ë  ê²ƒìœ¼ë¡œ ì˜ˆì¸¡ë©ë‹ˆë‹¤.</p>`;
                    } else {
                        resultText += `<p class="card-text fs-5">ğŸ“ˆ <strong>ì—ì´ì§• ì»¤ë¸Œ ì˜ˆì¸¡:</strong> ì‹œë®¬ë ˆì´ì…˜ ê¸°ê°„ ë‚´ ëšœë ·í•œ ê¸°ëŸ‰ í•˜ë½ì€ ì˜ˆì¸¡ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.</p>`;
                    }
                    
                    resultText += `
                                <img src="${data.plot_image}" class="img-fluid rounded mt-3" alt="ì˜ˆì¸¡ ê²°ê³¼ ê·¸ë˜í”„" />
                            </div>
                        </div>`;
                    resultsDiv.innerHTML = resultText;
                }
            } catch (error) {
                resultsDiv.innerHTML = `<div class="alert alert-danger" role="alert">ì„œë²„ í†µì‹  ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: ${error}</div>`;
            } finally {
                loadingDiv.style.display = 'none';
            }
        });
    </script>
</body>
</html>